# Предсказание индекса качества воздуха

## Описание проекта

В рамках проекта реализованы модели прогнозирования индекса качества воздуха на
основе загрязнителей воздуха и погоды<br>

Модели будет оценивать множество факторов, влияющих на качество воздуха. Среди
них:

- Скорость и направление ветра
- Температура и влажность воздуха
- Атмосферное давление
- Количество осадков
- Основные загрязнители воздуха

Модель будет анализировать данные из разных источников:

- Базы данных с историческими значениями о качестве воздуха
- Данные метеорологических станций

## Цель проекта

Предоставить возможность мониторинга прогнозного значения качества воздуха по
городам Центрального федерального округа на будущие периоды<br>

---

## Setup

### Пререквизиты

- Python >= 3.10
- uv

### Установка

Клонируем репозиторий и переходим в проект

```bash
git clone https://github.com/IvanMakhrov/air-quality-prediction.git
cd air-quality-prediction
```

Настраиваем зависимости

```bash
uv venv
source .venv/bin/activate
uv sync --all-extras
```

Проверяем код

```bash
pre-commit install
pre-commit run -a
```

## Train

### Загрузка данных

```bash
dvc repro download
```

### Обучение моделей

Архитектура базовой модели:

- Кол-во нейронов 2048
- Learning rate 1e-4
- Кол-во эпох 10
- 5 линейных слоев
- Функция активации RELU

Для запуска обучения базовой модели

```bash
air-quality-prediction train
```

Ддля продвинутой модели выбрана tabtransformer<br> Архитектура продвинутой
модели:

- d_token 32
- n_layers 4
- n_heads 4
- dropout 0.1
- max_epochs 10
- learning_rate 3e-4

Для запуска обучения tabtransformer

```bash
air-quality-prediction train model=tabtransformer
```

### Логирование в MLFlow

```bash
mlflow ui
```

Открываем http://127.0.0.1:8080 для контроля обучения моделей
